<div class="row" id="task">
    <alert type="danger" ng-if="taskCtrl.form.error">{{taskCtrl.form.error}}</alert>
    <h2>
        #{{taskCtrl.task.id}}
    </h2>
    <form id="edittask" role="form" ng-submit="taskCtrl.submit()">
        <fieldset>
            <div class="form-group col-md-3">
                <label for="taskname">Nom de la tâche</label>
                <input type="text" required ng-model="taskCtrl.task.name" class="form-control" id="taskname" name="taskName" placeholder="Nom de la tâche"/>
            </div>
            <div class="form-group col-md-3">
                <label for="state">Etat</label>

                <select ng-model="taskCtrl.task.stateId" required class="form-control" name="state" id="state" placeholder="Etat">
                    <option ng-selected="taskCtrl.task._links.state === state._links.self" value="{{state.id}}" ng-repeat="state in taskCtrl.states">
                        {{state.name}}
                    </option>
                </select>
            </div>
            <div class="form-group col-md-3">
                <label for="swimlane">Couloir</label>
                <select ng-model="edit.task.swimlaneId" class="form-control" id="swimlane" name="swimlane" placeholder="Etat">
                    <option ng-selected="taskCtrl.task._links.swimlane === swimlane._links.self" value="{{swimlane.id}}" ng-repeat="swimlane in taskCtrl.swimlanes">{{swimlane.name}}</option>
                </select>
            </div>
            <div class="form-group col-md-3">
                <label for="category">Catégorie</label>
                <select ng-model="edit.task.categoryId" class="form-control" id="category" name="category" placeholder="Catégorie">
                    <option ng-selected="taskCtrl.task._links.category === category._links.self" value="{{category.id}}" ng-repeat="category in taskCtrl.categories">{{category.name}}</option>
                </select>
            </div>
        </fieldset>
        <fieldset>
            <div class="form-group col-md-12">
                <label for="description">Description</label>
                <textarea rows="10" class="col-md-12" ng-model="taskCtrl.task.description" class="form-control" id="description" name="description" placeholder="Description"/>
            </div>
        </fieldset>
        <fieldset>
            <div class="form-group col-md-3">
                <label for="assignee">Assigné à </label>
                <select ng-model="taskCtrl.task.assigneeId" class="form-control" id="assignee" name="assignee" placeholder="Assigné à">
                    <option ng-selected="taskCtrl.task._links.assignee === member._links.self" value="{{member.id}}" ng-repeat="member in edit.members">{{member.user.username}}</option>
                </select>
            </div>
            <div class="form-group col-md-3">
                <label for="backup">Backup </label>
                <select ng-model="taskCtrl.task.backupId" class="form-control" id="backup" name="backup" placeholder="Backup">
                    <option ng-selected="taskCtrl.task._links.backup === member._links.self" value="{{member.id}}" ng-repeat="member in edit.members">{{member.user.username}}</option>
                </select>
            </div>
        </fieldset>
        <fieldset>
            <div class="form-group  col-md-3">
                <label for="plannedStart">Date de début prévue </label>
                <input type="date" id="plannedStart" class="form-control" ng-model="taskCtrl.task.plannedStart"/>
            </div>
            <div class="form-group col-md-3">
                <label for="plannedEnding">Date de fin prévue </label>
                <input type="date" id="plannedEnding" class="form-control" ng-model="taskCtrl.task.plannedEnding"/>
            </div>
            <div class="form-group col-md-3">
                <label for="estimatedLoad">Charge totale prévue</label>
                <input type="number" id="estimatedLoad" class="form-control" ng-model="taskCtrl.task.estimatedLoad" min="0" step="1"/>
            </div>
        </fieldset>
        <div class="col-md-offset-9 col-md-3 inline">
            <button type="button" onClick="history.back()" class="btn btn-info">Annuler</button>
            <button type="submit" class="btn btn-info">Enregistrer</button>
        </div>
    </form>
    <div class="panel">
        <div class="panel-body">
            <tabset>
                <tab heading="Commentaires" ng-controller="commentController as commentCtrl">
                    <div ng-include="'templates/project/task/comment/list.html'"></div>
                </tab> 
                <tab heading="Consommations" ng-controller="allocationController as allocationCtrl">
                    <div ng-include="'templates/project/task/allocation/list.html'"></div>
                </tab> 
                <tab heading="Historique" ng-controller="historyController as historyCtrl">
                    <div ng-include="'templates/project/task/history/list.html'"></div>
                </tab> 
            </tabset>
        </div>
    </div>
</div>