!function e(t,r,o){function n(l,s){if(!r[l]){if(!t[l]){var i="function"==typeof require&&require;if(!s&&i)return i(l,!0);if(a)return a(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[l]={exports:{}};t[l][0].call(u.exports,function(e){var r=t[l][1][e];return n(r?r:e)},u,u.exports,e,t,r,o)}return r[l].exports}for(var a="function"==typeof require&&require,l=0;l<o.length;l++)n(o[l]);return n}({1:[function(e,t,r){var o=e("./project/project.module"),n=e("./user/user.module");t.exports=angular.module("kanban.admin",[o.name,n.name])},{"./project/project.module":12,"./user/user.module":26}],2:[function(e,t,r){var o=function(e,t){var r=this;r.submit=function(){t.resource("self").save(r.project,function(){e.close()},function(e){r.error=e.data})}};o.$inject=["$uibModalInstance","projects"],t.exports=o},{}],3:[function(e,t,r){var o=function(e,t){var r=this;r.submit=function(){t.resource("category").save(r.category,function(){e.close()},function(e){r.error=e.data})}};o.$inject=["$uibModalInstance","project"],t.exports=o},{}],4:[function(e,t,r){var o=e("./list.controller"),n=e("./add.controller");t.exports=angular.module("kanban.admin.project.category",[]).controller("listCategoryAdminController",o).controller("addCategoryAdminController",n)},{"./add.controller":3,"./list.controller":5}],5:[function(e,t,r){var o=function(e,t){var r=this;r.add=function(){var o=e.open({animation:!0,templateUrl:"templates/admin/project/category/add.html",controller:"addCategoryAdminController",controllerAs:"addCategoryCtrl",resolve:{project:t},size:"md"});o.result.then(function(){r.reload()})},r["delete"]=function(e){e.resource("self")["delete"](null,function(){r.reload()})},r.saveCategory=function(e){var t=e.resource("self").save(e).$promise;return t["catch"](function(e){e.data=e.data.message}),t},r.reload=function(){r.categories=t.resource("category").query()},r.reload()};o.$inject=["$uibModal","project"],t.exports=o},{}],6:[function(e,t,r){var o=function(e,t){var r=this;r.project=t,e.transitionTo("app.project.edit.taskfield",{projectId:t.id})};o.$inject=["$state","project"],t.exports=o},{}],7:[function(e,t,r){var o=function(e,t,r,o){function n(){return r.get({page:a.projects.page.number,size:a.projects.page.size},function(){a.projects._embedded&&angular.forEach(a.projects._embedded.projectResourceList,function(e){return e.states=new o(e).resource("state").query(),e})})}var a=this;a.projects={page:{number:0,size:15}},a.projects=n(),a.add=function(){var r=e.open({animation:!0,templateUrl:"templates/admin/project/add.html",controller:"addProjectAdminController",controllerAs:"addProjectCtrl",resolve:{projects:a.projects},size:"md"});r.result.then(function(){t.$emit("kanban:projects-updates"),a.projects=n()})},a["delete"]=function(e){new o(e).resource("self")["delete"](function(){t.$emit("kanban:projects-updates"),a.projects=n()})}};o.$inject=["$uibModal","$scope","projectService","HateoasInterface"],t.exports=o},{}],8:[function(e,t,r){var o=function(e,t,r){var o=this;o.selectUser=function(e,t,r){o.member.user=t},o.getUsers=function(e){return t.query({search:e}).$promise},o.projectRoles=r.resource("roles").query(),o.submit=function(){r.resource("member").save(o.member,function(){e.close()},function(e){o.error=e.data})}};o.$inject=["$uibModalInstance","userService","project"],t.exports=o},{}],9:[function(e,t,r){var o=function(e,t,r){var o=this;o.projectRoles=t.resource("roles").query(),o.members={page:{number:0,size:15}},o.members=t.resource("member").get({page:o.members.page.number,size:o.members.page.size}),o.add=function(){var r=e.open({animation:!0,templateUrl:"templates/admin/project/member/add.html",controller:"addMemberAdminController",controllerAs:"addMemberCtrl",resolve:{project:t},size:"md"});r.result.then(function(){o.members=t.resource("member").get({page:o.members.page.number,size:o.members.page.size})})},o["delete"]=function(e){new r(e).resource("self")["delete"](null,function(){o.members=t.resource("member").get({page:o.members.page.number,size:o.members.page.size})})},o.saveMember=function(e){var t=new r(e).resource("self").save(e).$promise;return t["catch"](function(e){e.data=e.data.message}),t}};o.$inject=["$uibModal","project","HateoasInterface"],t.exports=o},{}],10:[function(e,t,r){var o=e("./list.controller"),n=e("./add.controller");t.exports=angular.module("kanban.admin.project.member",[]).controller("listMemberAdminController",o).controller("addMemberAdminController",n)},{"./add.controller":8,"./list.controller":9}],11:[function(e,t,r){var o=function(e){e.state("app.projects",{controller:"listProjectAdminController",controllerAs:"projectListAdminCtrl",templateUrl:"templates/admin/project/list.html",url:"project"}),e.state("app.project.edit",{controller:"editProjectAdminController",controllerAs:"projectEditCtrl",templateUrl:"templates/admin/project/project.html",url:"edit"}),e.state("app.project.edit.category",{controller:"listCategoryAdminController",controllerAs:"categoryListCtrl",templateUrl:"templates/admin/project/category/list.html",url:"/category"}),e.state("app.project.edit.swimlane",{controller:"listSwimlaneAdminController",controllerAs:"swimlaneListCtrl",templateUrl:"templates/admin/project/swimlane/list.html",url:"/swimlane"}),e.state("app.project.edit.member",{controller:"listMemberAdminController",controllerAs:"memberListCtrl",templateUrl:"templates/admin/project/member/list.html",url:"/member"}),e.state("app.project.edit.state",{controller:"listStateAdminController",controllerAs:"stateListCtrl",templateUrl:"templates/admin/project/state/list.html",url:"/state"}),e.state("app.project.edit.taskfield",{controller:"listTaskfieldAdminController",controllerAs:"taskfieldListCtrl",templateUrl:"templates/admin/project/taskfield/list.html",url:"/customfield"})};o.$inject=["$stateProvider"],t.exports=o},{}],12:[function(e,t,r){var o=e("./state/state.module"),n=e("./category/category.module"),a=e("./swimlane/swimlane.module"),l=e("./member/member.module"),s=e("./taskfield/taskfield.module"),i=e("./project.config"),c=e("./list.controller"),u=e("./add.controller"),d=e("./edit.controller");t.exports=angular.module("kanban.admin.project",["kanban.project",o.name,n.name,a.name,l.name,s.name]).config(i).controller("listProjectAdminController",c).controller("addProjectAdminController",u).controller("editProjectAdminController",d)},{"./add.controller":2,"./category/category.module":4,"./edit.controller":6,"./list.controller":7,"./member/member.module":10,"./project.config":11,"./state/state.module":15,"./swimlane/swimlane.module":18,"./taskfield/taskfield.module":22}],13:[function(e,t,r){var o=function(e,t){var r=this;r.submit=function(){t.resource("state").save(r.state,function(){e.close()},function(e){r.error=e.data})}};o.$inject=["$uibModalInstance","project"],t.exports=o},{}],14:[function(e,t,r){var o=function(e,t,r){var o=this;o.stateListSortOptions={orderChanged:function(e){var t=e.source.itemScope.modelValue,r=e.dest.index;t.position=r,t.resource("self").save(null,t)}},o.add=function(){var r=e.open({animation:!0,templateUrl:"templates/admin/project/state/add.html",controller:"addStateAdminController",controllerAs:"addStateCtrl",resolve:{project:t},size:"md"});r.result.then(function(){o.reload()})},o["delete"]=function(e){e.resource("self")["delete"](null,function(){o.reload()},function(e){r.error(e.data.message)})},o.saveState=function(e){var t=e.resource("self").save(e).$promise;return t["catch"](function(e){e.data=e.data.message}),t},o.reload=function(){o.states=t.resource("state").query()},o.reload()};o.$inject=["$uibModal","project","growl"],t.exports=o},{}],15:[function(e,t,r){var o=e("./list.controller"),n=e("./add.controller");t.exports=angular.module("kanban.admin.project.state",["angular-growl"]).controller("listStateAdminController",o).controller("addStateAdminController",n)},{"./add.controller":13,"./list.controller":14}],16:[function(e,t,r){var o=function(e,t){var r=this;r.submit=function(){t.resource("swimlane").save(r.swimlane,function(){e.close()},function(e){r.error=e.data})}};o.$inject=["$uibModalInstance","project"],t.exports=o},{}],17:[function(e,t,r){var o=function(e,t,r){var o=this;o.swimlaneListSortOptions={orderChanged:function(e){var t=e.source.itemScope.modelValue,r=e.dest.index;t.position=r,t.resource("self").save(null,t)}},o.add=function(){var r=e.open({animation:!0,templateUrl:"templates/admin/project/swimlane/add.html",controller:"addSwimlaneAdminController",controllerAs:"addSwimlaneCtrl",resolve:{project:t},size:"md"});r.result.then(function(){o.reload()})},o["delete"]=function(e){e.resource("self")["delete"](null,function(){o.reload()})},o.saveSwimlane=function(e){var t=e.resource("self").save(e).$promise;return t["catch"](function(e){e.data=e.data.message}),t},o.reload=function(){o.swimlanes=t.resource("swimlane").query(),o.swimlanes.$promise.then(function(e){angular.forEach(e,function(e){e.endPlanned&&(e.endPlanned=r(e.endPlanned).toDate())})})},o.reload()};o.$inject=["$uibModal","project","moment"],t.exports=o},{}],18:[function(e,t,r){var o=e("./list.controller"),n=e("./add.controller");t.exports=angular.module("kanban.admin.project.swimlane",[]).controller("listSwimlaneAdminController",o).controller("addSwimlaneAdminController",n)},{"./add.controller":16,"./list.controller":17}],19:[function(e,t,r){var o=function(e,t,r){var o=this;o.fieldTypes=r.query(),o.submit=function(){t.resource("taskfield").save(o.taskfield,function(){e.close()},function(e){o.error=e.data})}};o.$inject=["$uibModalInstance","project","fieldtypeService"],t.exports=o},{}],20:[function(e,t,r){var o=function(e){return e("/api/taskfieldtype")};o.$inject=["$resource"],t.exports=o},{}],21:[function(e,t,r){var o=function(e,t){var r=this;r.add=function(){var o=e.open({animation:!0,templateUrl:"templates/admin/project/taskfield/add.html",controller:"addTaskfieldAdminController",controllerAs:"addTaskfieldCtrl",resolve:{project:t},size:"md"});o.result.then(function(){r.reload()})},r["delete"]=function(e){e.resource("self")["delete"](null,function(){r.reload()})},r.reload=function(){r.taskfields=t.resource("taskfield").query()},r.reload()};o.$inject=["$uibModal","project"],t.exports=o},{}],22:[function(e,t,r){var o=e("./list.controller"),n=e("./add.controller"),a=e("./fieldtype.service");t.exports=angular.module("kanban.admin.project.taskfield",[]).service("fieldtypeService",a).controller("listTaskfieldAdminController",o).controller("addTaskfieldAdminController",n)},{"./add.controller":19,"./fieldtype.service":20,"./list.controller":21}],23:[function(e,t,r){var o=function(e,t,r){var o=this;o.roles=t.query(),o.submit=function(){o.error||r.save(o.user,function(){e.close()},function(e){o.error=e.data})}};o.$inject=["$uibModalInstance","userRoleService","userService"],t.exports=o},{}],24:[function(e,t,r){var o=function(e,t,r,o){var n=this;n.users={page:{number:0,size:15}},n.userRoles=o.query(),n.users=r.get({page:n.users.page.number,size:n.users.page.size}),n.add=function(){var t=e.open({animation:!0,templateUrl:"templates/admin/user/add.html",controller:"addUserAdminController",controllerAs:"addUserAdminCtrl",size:"md"});t.result.then(function(){n.users=r.get({page:n.users.page.number,size:n.users.page.size})})},n["delete"]=function(e){new t(e).resource("self")["delete"](null,function(){n.users=r.get({page:n.users.page.number,size:n.users.page.size})})},n.saveUser=function(e){return new t(e).resource("self").save(e).$promise}};o.$inject=["$uibModal","HateoasInterface","userService","userRoleService"],t.exports=o},{}],25:[function(e,t,r){var o=function(e){e.state("app.users",{templateUrl:"templates/admin/user/list.html",controller:"listUserAdminController",controllerAs:"usersCtrl",url:"users"})};o.$inject=["$stateProvider"],t.exports=o},{}],26:[function(e,t,r){var o=e("./user.config"),n=e("./list.controller"),a=e("./add.controller"),l=e("./user.service"),s=e("./userrole.service");t.exports=angular.module("kanban.admin.user",[]).config(o).controller("listUserAdminController",n).controller("addUserAdminController",a).service("userService",l).service("userRoleService",s)},{"./add.controller":23,"./list.controller":24,"./user.config":25,"./user.service":27,"./userrole.service":28}],27:[function(e,t,r){var o=function(e){return e("/api/user")};o.$inject=["$resource"],t.exports=o},{}],28:[function(e,t,r){var o=function(e){return e("/api/role")};o.$inject=["$resource"],t.exports=o},{}],29:[function(e,t,r){function o(e){return{request:function(t){return t.url&&-1===t.url.indexOf(".html")&&e.oauth&&(t.headers.authorization=e.oauth.token_type+" "+e.oauth.access_token,t.withCredentials=!0),t}}}o.$inject=["$sessionStorage"];var n=function(e,t,r){e.state("app",{"abstract":!0,templateUrl:"layout-app.html",controller:"appController",controllerAs:"appCtrl",url:"/",resolve:{currentuser:["currentUserService",function(e){return e.get()}]}}),e.state("app.dashboard",{templateUrl:"templates/dashboard/dashboard.html",controller:"dashboardController",controllerAs:"dashboardCtrl",url:"dashboard"}),e.state("app.profil",{templateUrl:"templates/profil/profil.html",controller:"profilController",controllerAs:"profilCtrl",url:"profil"}),e.state("login",{templateUrl:"login.html",controller:"loginController",controllerAs:"login",url:"/login"}),t.interceptors.push(o),r.transformAllResponses()};n.$inject=["$stateProvider","$httpProvider","HateoasInterceptorProvider"],t.exports=n},{}],30:[function(e,t,r){var o=function(e,t,r,o,n){var a=this;a.currentuser=t,t.$promise.then(function(){t.projects=t.resource("project").query(),t._links.photo&&e.get(t._links.photo).then(function(e){t.photo=e.data})}),a.logout=function(){delete o.oauth,n.transitionTo("login")},r.$on("kanban:projects-updates",function(){t.projects=t.resource("project").query()})};o.$inject=["$http","currentuser","$scope","$sessionStorage","$state"],t.exports=o},{}],31:[function(e,t,r){var o=e("./app.config"),n=e("./app.run"),a=e("./login/login.module"),l=e("./app.controller"),s=e("./dashboard/dashboard.module"),i=e("./project/project.module"),c=e("./directive/samePassword.directive"),u=e("./directive/error.directive"),d=e("./admin/admin.module"),m=e("./profil/profil.controller");angular.module("kanban",["ui.router","ngStorage","ngSanitize","ui.sortable","http-auth-interceptor","xeditable","ngResource","hateoas","ui.bootstrap","ui.bootstrap.tpls","ngImgCrop","textAngular",a.name,s.name,i.name,d.name]).config(o).run(n).controller("appController",l).controller("profilController",m).value("moment",moment).directive("samePassword",c).directive("errors",u)},{"./admin/admin.module":1,"./app.config":29,"./app.controller":30,"./app.run":32,"./dashboard/dashboard.module":35,"./directive/error.directive":36,"./directive/samePassword.directive":37,"./login/login.module":41,"./profil/profil.controller":42,"./project/project.module":54}],32:[function(e,t,r){var o=function(e,t,r,o,n,a){a.theme="bs3",e.loginOngoing=!1,e.$on("event:auth-forbidden",function(){r.go("app.dashboard")}),e.$on("event:auth-loginRequired",function(){delete t.oauth;var r=e.$new();e.loginOngoing||(e.loginOngoing=!0,r.modalInstance=o.open({animation:!0,backdrop:"static",templateUrl:"login.html",controller:"loginController",controllerAs:"login",scope:r,keyboard:!1,size:"md"}),r.modalInstance.result.then(function(){n.loginConfirmed(),e.loginOngoing=!1}))}),r.go("login")};o.$inject=["$rootScope","$sessionStorage","$state","$uibModal","authService","editableOptions"],t.exports=o},{}],33:[function(e,t,r){var o=function(e,t,r){var o=this;o.day=t,o.imputations=r.resource("consommation").query({date:1e3*t.format("X")}),o.addTask=function(e,t,r){var n={taskName:t.name,taskId:t.id,timeRemains:t.timeRemains,timeSpent:0},a=!1;angular.forEach(o.imputations,function(e){n.taskId===e.taskId&&(a=!0)}),a||o.imputations.push(n),o.addedTask=null},o.getTasks=function(e){return r.resource("task").query({search:e}).$promise},o.submit=function(){r.resource("consommation").save({date:1e3*t.format("X")},o.imputations,function(){e.close()})}};o.$inject=["$uibModalInstance","day","currentuser"],t.exports=o},{}],34:[function(e,t,r){var o=function(e,t,r,o,n,a){var l=this;l.tasks={page:{size:10,number:1}};var s=function(){r.$promise.then(function(){l.tasks=r.resource("task").get({page:l.tasks.page.number-1,size:l.tasks.page.size},function(e){return e._embedded&&angular.forEach(e._embedded.taskResourceList,function(e){e=o(e),e.project=new t(e).resource("project").get()}),e.page.number++,e}),l.calendarOptions={height:450,editable:!1,lang:"fr",header:{left:"title",center:"",right:"today prev,next"},viewRender:function(e,t){var r=a(e.start),o=a(e.end);l.loadCalendarEvent(1e3*r.format("X"),1e3*o.format("X"))},dayClick:dayOnClick}})};l.loadCalendarEvent=function(e,t){r.resource("task").query({start:e,end:t},function(e){angular.forEach(e,function(e){e=o(e),e.title=e.name,e.start=a(e.plannedStart).toDate(),e.end=a(e.plannedEnding).toDate(),e.allDay=!0,e._links.category?e.category.$promise.then(function(){e.backgroundColor=e.category.bgcolor,n.calendars.userCalendar.fullCalendar("renderEvent",e)}):n.calendars.userCalendar.fullCalendar("renderEvent",e)})})},r.$promise.then(s),dayOnClick=function(t){var o=e.open({animation:!0,templateUrl:"templates/dashboard/calendar/imputation.html",controller:"addImputationController",controllerAs:"addImputationCtrl",resolve:{day:function(){return t},currentuser:function(){return r}},size:"md"});o.result.then(s)},l.eventsSource=[]};o.$inject=["$uibModal","HateoasInterface","currentuser","taskAssemblerService","uiCalendarConfig","moment"],t.exports=o},{}],35:[function(e,t,r){var o=e("./dashboard.controller"),n=e("./calendar/addimputation.controller");t.exports=angular.module("kanban.dashboard",["ui.calendar"]).controller("dashboardController",o).controller("addImputationController",n)},{"./calendar/addimputation.controller":33,"./dashboard.controller":34}],36:[function(e,t,r){t.exports=function(){return{restrict:"E",scope:{errors:"=errors"},template:'<ul> <li ng-repeat="msg in errors.messages">{{msg.message}}</li></ul>'}}},{}],37:[function(e,t,r){var o=function(e,t){var r=null;return""!==t&&void 0!==e&&t!==e&&(r={message:"Les mots de passe saisis ne correspondent pas"}),r};t.exports=function(){return{restrict:"E",transclude:!0,scope:{password:"=password",placeholder:"@placeholder",error:"=error"},link:function(e,t,r,n){var a=t.children()[0];t.add(e.password).on("keyup",function(){e.error=o(e.password,a.value),e.$apply()}),e.$watch("password",function(){a.value&&(e.error=o(e.password,a.value))})},template:'<input type="password" class="form-control" id="rePassword" placeholder="{{placeholder}}"/>'}}},{}],38:[function(e,t,r){var o=function(e){return{login:function(t){var r={method:"POST",url:"/oauth/token",headers:{Authorization:"Basic "+btoa("clientapp:123456")},withCredentials:!0,params:{username:t.username,password:t.password,grant_type:"password",scope:"read write"}};return e(r)}}};o.$inject=["$http"],t.exports=o},{}],39:[function(e,t,r){var o=function(e){return e("/api/userProfile")};o.$inject=["$resource"],t.exports=o},{}],40:[function(e,t,r){var o=function(e,t,r,o){var n=this;n.authenticate=function(){o.login(n.loginForm).success(function(o){r.oauth=o,e.modalInstance&&e.modalInstance.close(),t.transitionTo("app.dashboard")}).error(function(){n.loginForm={},n.loginForm.error="Login/password invalide"})}};o.$inject=["$scope","$state","$sessionStorage","appAuthService"],t.exports=o},{}],41:[function(e,t,r){var o=e("./login.controller"),n=e("./auth.service"),a=e("./currentuser.service");t.exports=angular.module("kanban.login",[]).controller("loginController",o).service("appAuthService",n).service("currentUserService",a)},{"./auth.service":38,"./currentuser.service":39,"./login.controller":40}],42:[function(e,t,r){var o=function(e,t,r){var o=this;r.$promise.then(function(){o.profil=r,r._links.member&&(o.profil.members=r.resource("member").query())});var n=function(t){var r=t.currentTarget.files[0],n=new FileReader;n.onload=function(t){e.$apply(function(){o.profil.photoTemp=t.target.result})},n.readAsDataURL(r)};angular.element(document.querySelector("#photoProfil")).on("change",n),o.save=function(){if(!o.error){var e=new FormData;e.append("id",o.profil.id),void 0!==o.profil.password&&e.append("password",o.profil.password),e.append("email",o.profil.email),e.append("photo",o.profil.photo),t({method:"POST",url:r._links.self,data:e,headers:{"Content-Type":void 0},transformRequest:angular.identity})}}};o.$inject=["$scope","$http","currentuser"],t.exports=o},{}],43:[function(e,t,r){var o=function(e){e.state("app.project.consommation",{controller:"consommationController",controllerAs:"consommationCtrl",templateUrl:"templates/project/consommation/member.html",url:"consommation"})};o.$inject=["$stateProvider"],t.exports=o},{}],44:[function(e,t,r){function o(e,t){for(var r=[],o=e(t),n=0;7>n;n++)r.push(o),o=e(o).add(1,"days");return r}function n(e,t,r){for(var o=[],n=e(t);n.month()===r;)o.push(n),n=e(n).add(1,"days");return o}var a=function(e,t,r){var a=this;a.precision="week",a.start=e().startOf("isoWeek");var l=e(a.start);a.showDetail=function(e){e.showDetails=!0},a.hideDetail=function(e){e.showDetails=!1},a.precisionChange=function(){a.days=[],"week"===a.precision?(a.start=a.start.startOf("isoWeek"),a.days=o(e,a.start),l=e(a.start).add(8,"days"),a.entries=r.loadConsommations(t,a.start,l)):(a.start=a.start.startOf("month"),a.days=n(e,a.start,a.start.month()),l=e(a.start).add(1,"months"),a.entries=r.loadConsommations(t,a.start,l),a.entries.$promise.then(function(){var e=r.groupByWeek(a.entries,a.days);a.entries=e.entries,a.days=e.weeks}))},a.previous=function(){"week"===a.precision?a.start=a.start.subtract(7,"days"):a.start=a.start.subtract(1,"months"),a.precisionChange()},a.next=function(){"week"===a.precision?a.start=a.start.add(7,"days"):a.start=a.start.add(1,"months"),a.precisionChange()},a.precisionChange()};a.$inject=["moment","project","consomationService"],t.exports=a},{}],45:[function(e,t,r){var o=e("./consommation.config"),n=e("./consommation.controller"),a=e("./consommation.service");t.exports=angular.module("kanban.project.consommation",[]).config(o).controller("consommationController",n).service("consomationService",a)},{"./consommation.config":43,"./consommation.controller":44,"./consommation.service":46}],46:[function(e,t,r){function o(e){var t,r=[],o=[],n=0;return angular.forEach(e,function(e){t&&e.week()===t||(t=e.week(),n++),o[n]||(o[n]=[]),o[n].push(e)}),angular.forEach(o,function(e){var t={id:e[0].week(),label:e[0].format("DD/MM")+" au "+e[e.length-1].format("DD/MM"),days:e};r.push(t)}),r}var n=function(){return{loadConsommations:function(e,t,r){return e.resource("member").query(function(e){angular.forEach(e,function(e){e.imputations=e.resource("imputation").get({start:1e3*t.format("X"),end:1e3*r.format("X")})})})},groupByWeek:function(e,t){var r={weeks:o(t),entries:e};return angular.forEach(e,function(e){e.imputations.$promise.then(function(){var t=[];angular.forEach(r.weeks,function(r){var o=0;angular.forEach(r.days,function(t){o+=e.imputations.imputations[t.format("DD/MM/YYYY")]}),t[r.id]=o}),e.imputations.imputations=t,angular.forEach(e.imputations.details,function(e){var t=[];angular.forEach(r.weeks,function(r){var o=0;angular.forEach(r.days,function(t){o+=e.imputations[t.format("DD/MM/YYYY")]}),t[r.id]=o}),e.imputations=t})})}),r}}};n.$inject=[],t.exports=n},{}],47:[function(e,t,r){var o=function(e,t){var r=this;r.addTask=function(){var r=e.open({animation:!0,templateUrl:"templates/project/task/add.html",controller:"addTaskController",controllerAs:"addTaskCtrl",resolve:{project:function(){return t}},size:"md"});r.result.then(function(){})}};o.$inject=["$uibModal","project"],t.exports=o},{}],48:[function(e,t,r){var o=e("./gantt.controller");t.exports=angular.module("kanban.project.gantt",[]).controller("ganttController",o)},{"./gantt.controller":47}],49:[function(e,t,r){var o=function(e,t,r){var o=this,n=function(){o.states=t.resource("state").query({kanban:!0}),o.swimlanes=r.load(t)};t.$promise.then(n),o.addTask=function(){var r=e.open({animation:!0,templateUrl:"templates/project/task/add.html",controller:"addTaskController",controllerAs:"addTaskCtrl",resolve:{project:function(){return t}},size:"md"});r.result.then(n)},o.kanbanSortOptions={itemMoved:function(e){var r=e.source.itemScope.modelValue;r.state.id=e.dest.sortableScope.element.attr("data-columnindex");var n=e.dest.sortableScope.element.attr("data-rowindex");n?(r.swimlane||(r.swimlane={}),r.swimlane.id=e.dest.sortableScope.element.attr("data-rowindex")):r.swimlane=null,r.resource("self").save(null,r,function(){o.states=t.resource("state").query({order:"position"})})}},o.toggleSwimlane=function(e){$(e.target).parent().parent().toggleClass("kanban__swimlane--collapsed")}};o.$inject=["$uibModal","project","kanbanService"],t.exports=o},{}],50:[function(e,t,r){var o=e("./kanban.controller"),n=e("./kanban.service");t.exports=angular.module("kanban.project.kanban",[]).controller("kanbanController",o).service("kanbanService",n)},{"./kanban.controller":49,"./kanban.service":51}],51:[function(e,t,r){var o=function(e,t){var r=function(e){return angular.forEach(e,function(e){e=t(e)}),e},o=function(e,t,o){var n=[],a=0;return angular.forEach(t,function(t){n[a]={id:t.id},n[a].tasks=e.resource("task").query({swimlane:o,state:t.id},r),a++}),n},n=function(e,t){var o=[],n=0;return angular.forEach(t,function(t){o[n]={id:t.id},o[n].tasks=e.resource("task").query({noswimlane:!0,state:t.id},r),n++}),o};return{load:function(t){var r=[];return t.$promise.then(function(){var a=t.resource("state").query({kanban:!0}),l=t.resource("swimlane").query();e.all([a.$promise,l.$promise]).then(function(e){var a=e[0],l=e[1];angular.forEach(l,function(e){r.push(e),e.states=o(t,a,e.id)});var s={states:a=n(t,a)};r.push(s)})}),r}}};o.$inject=["$q","taskAssemblerService"],t.exports=o},{}],52:[function(e,t,r){var o=function(e,t){return t.get({projectId:e.projectId})};o.$inject=["$stateParams","projectService"];var n=function(e,t,r){var o=e.defer();return r.$promise.then(function(){var e="ADMIN"===r.applicationRole;r.resource("member").get({projectId:t.projectId},function(t){var r=t.projectRole,n={hasAdminRights:e||"MANAGER"===r,hasEditRights:e||"MANAGER"===r||"CONTRIBUTOR"===r,hasReadRights:e||r};o.resolve(n)})}),o.promise};n.$inject=["$q","$stateParams","currentuser"];var a=function(e){e.state("app.project",{"abstract":!0,controller:"projectController",controllerAs:"projectCtrl",templateUrl:"templates/project/layout-single.html",url:"project/:projectId/",resolve:{project:o,userRights:n}}),e.state("app.project.kanban",{templateUrl:"templates/project/kanban/kanban.html",controller:"kanbanController",controllerAs:"kanbanCtrl",url:"kanban"}),e.state("app.project.gantt",{templateUrl:"templates/project/gantt/gantt.html",controller:"ganttController",controllerAs:"ganttCtrl",url:"gantt"})};a.$inject=["$stateProvider"],t.exports=a},{}],53:[function(e,t,r){var o=function(e,t,r){var o=this;o.project=t,r.hasReadRights||e.transitionTo("app.dashboard"),o.rights=r};o.$inject=["$state","project","userRights"],t.exports=o},{}],54:[function(e,t,r){var o=e("./kanban/kanban.module"),n=e("./task/task.module"),a=e("./consommation/consommation.module"),l=e("./gantt/gantt.module"),s=e("./project.config"),i=e("./project.controller"),c=e("./project.service");t.exports=angular.module("kanban.project",[o.name,n.name,a.name,l.name]).config(s).controller("projectController",i).service("projectService",c)},{"./consommation/consommation.module":45,"./gantt/gantt.module":48,"./kanban/kanban.module":50,"./project.config":52,"./project.controller":53,"./project.service":55,"./task/task.module":68}],55:[function(e,t,r){var o=function(e){return e("/api/project/:projectId")};o.$inject=["$resource"],t.exports=o},{}],56:[function(e,t,r){var o=function(e,t){var r=this;r.categories=t.resource("category").query(),r.swimlanes=t.resource("swimlane").query(),r.submit=function(){t.resource("task").save(r.task,function(){e.close()},function(e){r.error=e.data})}};o.$inject=["$uibModalInstance","project"],t.exports=o},{}],57:[function(e,t,r){var o=function(e,t,r){var o=this;o.getMembers=function(e){return r.resource("member").query({search:e}).$promise},o.selectMember=function(e,t,r){o.allocation.member=t},o.submit=function(){t.resource("allocation").save(o.allocation,function(){e.close()},function(e){o.error=e.data})}};o.$inject=["$uibModalInstance","task","project"],t.exports=o},{}],58:[function(e,t,r){var o=e("./list.controller"),n=e("./add.controller");t.exports=angular.module("kanban.project.task.allocation",[]).controller("allocationListController",o).controller("allocationAddController",n)},{"./add.controller":57,"./list.controller":59}],59:[function(e,t,r){var o=function(e,t,r){var o=this;o.add=function(){var n=e.open({animation:!0,templateUrl:"templates/project/task/allocation/add.html",controller:"allocationAddController",controllerAs:"addAllocationCtrl",resolve:{task:function(){return t},project:function(){return r}},size:"xd"});n.result.then(function(){o.allocations=t.resource("allocation").query()})},o["delete"]=function(e){e.resource("self")["delete"](null,function(){o.allocations=t.resource("allocation").query()})},o.allocations=t.allocations=t.resource("allocation").query()};o.$inject=["$uibModal","task","project"],t.exports=o},{}],60:[function(e,t,r){var o=function(e,t,r){var o=this;r.id&&(o.parentComment=r),o.submit=function(){o.parentComment?o.parentComment.resource("reply").save(o.comment,function(){e.close()},function(e){o.error=e.data}):t.resource("comment").save(o.comment,function(){e.close()},function(e){o.error=e.data})}};o.$inject=["$uibModalInstance","task","comment"],t.exports=o},{}],61:[function(e,t,r){var o=e("./list.controller"),n=e("./add.controller"),a=e("./reply.controller");t.exports=angular.module("kanban.project.task.comment",[]).controller("commentListController",o).controller("commentAddController",n).controller("commentReplyController",a)},{"./add.controller":60,"./list.controller":62,"./reply.controller":63}],62:[function(e,t,r){var o=function(e,t){var r=this,o=t.taskCtrl.task;r.add=function(){var t=e.open({animation:!0,templateUrl:"templates/project/task/comment/add.html",controller:"commentAddController",controllerAs:"addCommentCtrl",resolve:{task:function(){return o},comment:{}},size:"md"});t.result.then(function(){r.comments=o.resource("comment").query()})},r.reply=function(t){var n=e.open({animation:!0,templateUrl:"templates/project/task/comment/add.html",controller:"commentAddController",controllerAs:"addCommentCtrl",resolve:{comment:function(){return t},task:function(){return o}},size:"md"});n.result.then(function(){t.showComment=!0,r.selectedComment=t.resource("reply").query()})},r.showHideReply=function(e){e.showComment?e.showComment=!1:(r.selectedComment=e.resource("reply").query(),e.showComment=!0)},r["delete"]=function(e,t){t.resource("self")["delete"](null,function(){null!==e?r.selectedComment=e.resource("reply").query():(r.comments=o.resource("comment").query(),r.selectedComment===t&&(r.selectedComment=null))})},o.$promise.then(function(){r.comments=o.resource("comment").query()})};o.$inject=["$uibModal","$scope"],t.exports=o},{}],63:[function(e,t,r){var o=function(e){var t=this;e.$watch("commentListCtrl.selectedComment",function(e,r){var o=e;o.$promise.then(function(e){t.replies=e})})};o.$inject=["$scope"],t.exports=o},{}],64:[function(e,t,r){var o=function(){};o.$inject=[],t.exports=o},{}],65:[function(e,t,r){var o=function(e,t,r,o){var n=this;n.loadPage=function(){t.resource("task").get({page:n.tasks.page.number-1,size:n.tasks.page.size,sort:n.sort.field,sortDirection:n.sort.sortDirection},function(e){e._embedded&&angular.forEach(e._embedded.taskResourceList,r),e.page.number++,n.tasks=e})},n.tasks={page:{size:10,number:1}},n.sort={field:"name",sortDirection:"desc"},n.loadPage(),n["delete"]=function(e){new o(e).resource("self")["delete"](n.loadPage);
},n.addTask=function(){var r=e.open({animation:!0,templateUrl:"templates/project/task/add.html",controller:"addTaskController",controllerAs:"addTaskCtrl",resolve:{project:function(){return t}},size:"md"});r.result.then(n.loadPage)},n.tableFilter=function(e){n.sort.field!==e&&(n.sort.sortDirection=""),n.sort.sortDirection="desc"===n.sort.sortDirection?"asc":"desc",n.sort.field=e,n.loadPage()}};o.$inject=["$uibModal","project","taskAssemblerService","HateoasInterface"],t.exports=o},{}],66:[function(e,t,r){var o=function(e,t){return t.get({projectId:e.projectId,taskId:e.taskId})};o.$inject=["$stateParams","taskService"];var n=function(e){e.state("app.project.tasks",{templateUrl:"templates/project/task/list.html",controller:"tasklistController",controllerAs:"tasksCtrl",url:"tasks"}),e.state("app.project.task",{templateUrl:"templates/project/task/task.html",controller:"taskController",controllerAs:"taskCtrl",resolve:{task:o},url:"task/:taskId"}),e.state("app.project.task.allocation",{templateUrl:"templates/project/task/allocation/list.html",controller:"allocationListController",controllerAs:"allocationListCtrl",url:"/allocation"})};n.$inject=["$stateProvider"],t.exports=n},{}],67:[function(e,t,r){var o=function(e,t,r,o,n,a){var l=this;l.customFieldMap={},l.task=o,r.$promise.then(function(){o.$promise.then(function(){l.task=n(o)}),l.categories=r.resource("category").query(),l.states=r.resource("state").query(),l.swimlanes=r.resource("swimlane").query();var t=r.resource("taskfield").query();e.all([t.$promise,o.$promise]).then(function(e){l.task.customField=[],angular.forEach(e[0],function(e){l.customFieldMap[e.fieldName]={definition:e},l.task.customField.push(l.customFieldMap[e.fieldName])}),l.task.resource("customfield").query(function(e){angular.forEach(e,function(e){l.customFieldMap[e.fieldName].fieldValue=e.fieldValue})})})}),l.selectAssignee=function(e,t,r){var o=!1;angular.forEach(l.task.assignees,function(e){e.id===t.id&&(o=!0,a.error("Utilisateur déjà assigné"))}),o||l.task.assignees.push(t)},l.removeuser=function(e){l.task.assignees.splice(e,1)},l.getMembers=function(e){return r.resource("member").query({search:e}).$promise},l.submit=function(){angular.forEach(l.task.customField,function(e){l.customFieldMap[e.definition.fieldName].value&&(e.value=l.customFieldMap[e.definition.fieldName].value)}),l.task.resource("self").save(l.task,function(){t.transitionTo("app.project.kanban",{projectId:r.id})},function(e){l.error=e.data})}};o.$inject=["$q","$state","project","task","taskAssemblerService","growl"],t.exports=o},{}],68:[function(e,t,r){var o=e("./comment/comment.module"),n=e("./allocation/allocation.module"),a=e("./task.config"),l=e("./add.controller"),s=e("./list.controller"),i=e("./task.controller"),c=e("./history/history.controller"),u=e("./task.service"),d=e("./taskAssembler.service");t.exports=angular.module("kanban.project.task",[o.name,n.name]).config(a).controller("addTaskController",l).controller("tasklistController",s).controller("taskController",i).controller("historyController",c).service("taskService",u).service("taskAssemblerService",d)},{"./add.controller":56,"./allocation/allocation.module":58,"./comment/comment.module":61,"./history/history.controller":64,"./list.controller":65,"./task.config":66,"./task.controller":67,"./task.service":69,"./taskAssembler.service":70}],69:[function(e,t,r){var o=function(e){return e("/api/project/:projectId/task/:taskId",{projectId:"@projectId",id:"@taskId"})};o.$inject=["$resource"],t.exports=o},{}],70:[function(e,t,r){var o=function(e,t,r){return function(o){var n=o;if(o.resource||(n=new t(o)),o.state=n.resource("state").get(),o._links.category&&(o.category=n.resource("category").get()),o._links.swimlane&&(o.swimlane=n.resource("swimlane").get()),o.assignees=n.resource("assignee").query(function(t){return angular.forEach(t,function(t){t._links.photo&&e.get(t._links.photo).then(function(e){t.photo=e.data})}),t}),o.exceededLoad=o.timeRemains+o.timeSpent>o.estimatedLoad,null!==n.plannedEnding){var a=r();o.plannedEnding=r(n.plannedEnding).toDate(),o.state.$promise.then(function(){o.exceededDate=a.isAfter(o.plannedEnding,"day")&&!o.state.closeState})}return null!==n.plannedStart&&(o.plannedStart=r(n.plannedStart).toDate()),o}};o.$inject=["$http","HateoasInterface","moment"],t.exports=o},{}]},{},[31]);